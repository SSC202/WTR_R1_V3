# WTR_R1 

## 工程简介

第23届全国大学生机器人大赛ROBOCON，哈尔滨工业大学（深圳）南工问天战队R1整车工程。

```
.
|- MainBoard 	## 主控板工程
|- ServoBoard	## DJI A Board工程
|- Readme.md	## 工程介绍
```

## 机械部分简介

整车采用双夹爪取放苗(带存苗)+夹爪摩擦轮取射球方案。

## 电控部分简介

整车采用STM32H743VET6(极客科技)进行控制，附加的DJI A Board作为激光转接板使用。

## 注意事项

### 电控/硬件注意事项

- 硬件制板前，电控组需要对全部的传感器和电机进行测试并使用CubeMX进行需求整理。**硬件组需要严格遵守电控组给出的需求进行主控板制作，不得擅自更改电控组要求**。

- 电源

  > - 主控板和分线/大功率驱动板应当产生电气隔离，避免大功率驱动板(如舵机驱动板)对主控造成不利影响。
  > - 建议使用双电源供电，小电源对主控板供电，大电源对功率板供电。
  > - 硬件设计时应当考虑电机堵转/舵机堵转产生的电流冲击。

- 通信

  > - CAN网负载不宜过多，8个以下为宜。使用CAN网时，检查终端电阻是否匹配。CAN线应当使用双绞线减少电磁干扰。
  > - SPI通信抗扰能力差，不建议使用SPI通信。
  > - 无线通信尽量使用不常用频段(2.4GHz以外)并使用大功率天线(20dBm以上)，**因为备赛场和主场的电磁环境及其复杂，容易导致丢包。**

- 主控

> - 使用F系列进行主控是比较可靠的，H系列由于架构变化，使用时可能会产生某些意想不到的bug。
> - 如果此车可手动，一定先进行手动逻辑测试和手动/自动切换系统构建。**底盘控制不可靠的情况下，手动必然比自动快速。**
> - 全向轮控制分为平移和方向控制，注意**方向控制应留有40%以上的速度余量**。

### 电控/机械注意事项

- 接线

> - 机械应当为电控提供走线和安放主控板的空间，主控板应当固定在底盘上，走线应当沿有减重孔的铝管进行布线，二者都应当避开存在运动的机构。
> - 如果存在直径较为细的线，应当用  进行保护防止意外断裂。
> - 尽量不要存在不等长的线以避免长线弯曲。
> - 尽量使用有卡扣的插口(XH,XT)或者用螺纹固定的插口。
> - 尽量使用粗线而非细线。
> - 尽量避免使用杜邦线，如果存在杜邦线，插口应当存在防止脱落的限位或者使用胶接。
> - 线的长度不宜太长（辨识困难），也不宜太短（容易断裂）。
> - 天线应当避开走线密集的区域。
> - 如果存在运动机构走线，使用(a)滑环(线要够粗，适用于旋转机构) (b)坦克带(线要够长，适用于平动机构) 
> - 尽量使用螺栓固定的压线端子，弹簧结构的接线端子容易接触不良。弹簧结构的接线端子适用于(a)粗线 (b)杜邦线公头线。

- 机械设计

> - **电控逻辑越简单越快。**所以当电控组提出的"XX比XX快"之类的要求时，机械组应当考虑此问题。
> - 机械组应当和电控组有充分交流，电控组能够帮助机械组改进机构。
> - 尽量减小电流冲击，提倡使用气动元件减少电流冲击，电机/舵机堵转及其容易产生电流冲击。
> - **上层机构以简单为重点，上层机构越复杂，实现难度越高，失败率越大(参考另一台摩擦带取苗的R1)。**
> - **上层机构注意细节，版本迭代时不要大改而是从细节上解决问题。**
> - 底盘及其重要，好的底盘是半自动的支撑。

### 电控组注意事项

- 代码习惯

> - 代码建议分层编写，从**底层驱动->中间层接口->应用层动作->用户系统架构**进行编写。
> - 初期代码要慢速，便于看出问题。
> - 可以使用全局变量，但是要符合命名规范。
> - **注释！！！**
> - 如果有两个人以上负责工程，应当事先沟通好工程接口和通信协议。
